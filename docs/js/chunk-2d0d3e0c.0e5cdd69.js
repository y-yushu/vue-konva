(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d3e0c"],{"5f49":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-container"},[t._m(0),e("div",{staticStyle:{"margin-bottom":"10px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.opendialog1()}}},[t._v("上传背景")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.opendialog2()}}},[t._v("增加文字")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.getPicture()}}},[t._v("下载图片")])],1),e("div",{ref:"container",attrs:{id:"container"}}),e("el-dialog",{attrs:{title:"选择背景",visible:t.visible1,width:"30%"},on:{"update:visible":function(e){t.visible1=e}}},[e("input",{ref:"file",attrs:{type:"file",accept:"image/png, image/jpeg"},on:{change:t.changeFile}})]),e("el-dialog",{attrs:{title:"文字信息",visible:t.visible2,width:"30%"},on:{"update:visible":function(e){t.visible2=e}}},[e("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"输入字号"},model:{value:t.textProp.fontSize,callback:function(e){t.$set(t.textProp,"fontSize",e)},expression:"textProp.fontSize"}},[e("template",{slot:"prepend"},[t._v("输入字号")])],2),e("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"输入色号"},model:{value:t.textProp.fill,callback:function(e){t.$set(t.textProp,"fill",e)},expression:"textProp.fill"}},[e("template",{slot:"prepend"},[t._v("输入色号")])],2),e("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"输入文本"},model:{value:t.textProp.text,callback:function(e){t.$set(t.textProp,"text",e)},expression:"textProp.text"}},[e("template",{slot:"prepend"},[t._v("输入文本")])],2),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addTest()}}},[t._v("添加")])],1)],1)],1)},n=[function(){var t=this,e=t._self._c;return e("div",[e("h1",[t._v("生成背景图片")])])}],r=i("362d"),l=i.n(r),s={name:"GenerateBackground",data(){return{pageStage:null,layer:null,tran:null,texts:[],visible1:!1,visible2:!1,textProp:{x:0,y:0,text:"Simple Text",fontSize:45,fontFamily:"Calibri",fill:"#ffffff",draggable:!0}}},methods:{opendialog1(){this.visible1=!0},opendialog2(){if(!this.layer)return this.$message.error("请先上传背景");this.visible2=!0},getPicture(){if(!this.layer)return this.$message.error("请先上传背景");this.tran.nodes([]),this.layer.draw();const t=document.createElement("a");t.href=this.pageStage.toDataURL(),t.download="text.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)},changeFile(){const t=this.$refs.file.files[0];if(!t)return;const e=new FileReader;e.onloadend=t=>{const e=new Image;e.src=t.target.result,e.onload=()=>{this.visible1=!1,this.pageStage=new l.a.Stage({container:"container",width:e.width,height:e.height});const t=new l.a.Layer;this.pageStage.add(t);const i=new l.a.Image({image:e,x:0,y:0,width:e.width,height:e.height,draggable:!1});i.cache(),i.filters([l.a.Filters.Brighten]),t.add(i),t.draw(),this.layer=t,this.clickTap()}},e.readAsDataURL(t)},addTest(){this.visible2=!1;const t=new l.a.Text(this.textProp);if(this.tran)this.tran.nodes([t]);else{const e=new l.a.Transformer({nodes:[t],centeredScaling:!1});this.layer.add(e),this.tran=e}this.texts.push(t),this.layer.add(t),this.layer.batchDraw()},clickTap(){this.pageStage.on("click tap",t=>{if(this.texts){const e=this.texts.find(e=>t.target===e);e?this.tran.nodes([e]):this.tran.nodes([]),this.layer.draw()}})}}},o=s,c=i("2877"),d=Object(c["a"])(o,a,n,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d0d3e0c.0e5cdd69.js.map